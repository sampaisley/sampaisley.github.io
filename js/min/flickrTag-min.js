function sortbydate(e,t){return e.datetaken>t.datetaken?1:e.datetaken<t.datetaken?-1:0}function go(e){function t(e,t){return new RegExp("\\b"+t+"\\b","gi").test(e)}function r(e){e=e||currentThumb,e<images.length?theImage.src=images[e][0]:(theImage.src="../img/noImage.jpg",timeoutID=window.setTimeout(function(){i(dragger.style.left)},300))}function i(e){var t=parseInt(e)-grid_size;dragger.style.left=t+"px",dragger.innerHTML=currentThumb,window.clearTimeout(timeoutID),currentThumb--,r(),s(),title.classList.remove("noImage")}function s(e){e=e||currentThumb,e<images.length?title.innerHTML=images[e][2]:title.innerHTML="No Image"}function o(e){var t,i,o;oldNumOfPhotos>e&&parseInt(dragger.style.top)+1.5*grid_size>high&&(t=Math.ceil(e/squaresAccross-1)*grid_size+"px",dragger.style.top=t,i=parseInt(dragger.style.top)/grid_size,o=parseInt(dragger.style.left)/grid_size,_X=o,_Y=i*squaresAccross,dragger.innerHTML=i*squaresAccross+o+1,currentThumb=i*squaresAccross+o,r(),s()),oldNumOfPhotos=e}function n(e,t){dragger.style.left=e+"px",dragger.style.top=t+"px"}function c(e,t,r){var i=document.querySelectorAll(e),s;for(s=i.length;s--;)i[s].classList.remove(t);r.classList.add(t)}function a(e){var t=3,r=Math.ceil(e/t);checkers.style.height=r*grid_size+2*borderWidth+"px",checkers.style.width=t*grid_size+2*borderWidth+"px",wide=document.querySelector("#checkers").clientWidth,high=document.querySelector("#checkers").clientHeight,squaresAccross=wide/grid_size,o(e)}function g(e,t){for(thumbDiv.innerHTML="",t=0;numOfThumbs>t;++t)e=document.createElement("img"),e.src=images[t][3],e.className="thumb",e.id=t,thumbDiv.appendChild(e)}function u(){dragger.classList.toggle("hidden"),checkers.classList.toggle("checks"),thumbDiv.classList.toggle("hidden"),g(),thumbsMode?toggleMode.innerHTML="Dragger":toggleMode.innerHTML="Thumbs",thumbsMode&&currentThumb<images.length&&c(".thumb","active",document.getElementById(currentThumb))}function d(t){jso=t.photos.photo,makeArray(e),r(),s(),a(images.length),thumbsMode&&u()}function m(e){_X=e.position.x/grid_size,_Y=Math.floor(e.position.y/grid_size*squaresAccross),currentThumb=_Y+_X,dragger.innerHTML=currentThumb+1,s(),currentThumb!==dragStartPoint&&title.classList.add("moving"),currentThumb>images.length-1?title.classList.add("noImage"):title.classList.remove("noImage")}function l(){r(),s(),title.classList.remove("moving")}var h="https://api.flickr.com/services/rest/?method=flickr.people.getPhotos&api_key=857e33af61016743c64d4aa90fa4782a&user_id=100786833%40N08&tags="+e+"&extras=tags%2Curl_n%2Curl_c%2Curl_sq%2Cdate_taken&format=json",f=document.createElement("script");f.type="text/javascript",f.src=h,document.head.appendChild(f),thumbDiv.addEventListener("click",function(e){"IMG"===e.target.nodeName&&(currentThumb=e.target.getAttribute("id"),r(),s(),dragger.innerHTML=parseInt(currentThumb)+1,e.target.offsetLeft%grid_size===0?n(e.target.offsetLeft,e.target.offsetTop):n(e.target.offsetLeft-borderWidth,e.target.offsetTop-borderWidth),c(".thumb","active",e.target),title.classList.remove("moving"))},!1),thumbDiv.addEventListener("mouseover",function(e){if("IMG"===e.target.nodeName){var t=e.target.id;s(t),currentThumb!==t?title.classList.add("moving"):title.classList.remove("moving")}},!1),thumbDiv.addEventListener("mouseout",function(){title.classList.remove("moving"),s()},!1),thumbDiv.addEventListener("dblclick",function(e){"IMG"===e.target.nodeName&&popLargeImage()},!1),toggleMode.onclick=function(){thumbsMode=!thumbsMode,u()};var p=new Draggabilly(dragger,{grid:[grid_size,grid_size],containment:!0});p.on("dragStart",function(){dragStartPoint=currentThumb}),p.on("dragMove",m),p.on("dragEnd",l)}function makeArray(e){var t,r,i,s,o;for(images=[],t=jso.length;t--;)wordInString(jso[t].tags,e)&&(numOfThumbs++,r=jso[t].url_n,i=jso[t].url_sq,tag=jso[t].tags,tit=jso[t].title,s=jso[t].datetaken,o=jso[t].url_c,images.unshift([r,tag,tit,i,s,o]))}function changeSet(e){numOfThumbs=0,makeArray(tag=e),setTitle(),setDivHeight(images.length),setImage(),thumbsMode&&(thumbs(),setActiveClass(".thumb","active",document.getElementById(currentThumb)))}function popLargeImage(){pops.src=images[currentThumb][5],popsDiv.classList.toggle("hidden"),popsTitle.innerHTML=images[currentThumb][2]}var dragger=document.querySelector("#draggable"),checkers=document.querySelector("#checkers"),thumbDiv=document.querySelector("#thumbs"),toggleMode=document.querySelector("#toggleMode"),numOfThumbs=0,borderWidth=10;checkers.style.borderWidth=borderWidth+"px";var theImage=document.querySelector("#theImage"),title=document.querySelector("#title"),france=document.querySelector("#francia"),field=document.querySelector("#food"),sea=document.querySelector("#briny"),numbers=document.querySelector("#numbers"),tit,grid_size=dragger.offsetWidth,wide=document.querySelector("#checkers").clientWidth,high=document.querySelector("#checkers").clientHeight,squaresAccross=wide/grid_size,thumbsMode=!0,images=[],Draggabilly,jso={},tag="food",currentThumb=0,dragStartPoint=0,_X=0,_Y=0,oldNumOfPhotos,timeoutID;france.onclick=numbers.onclick=field.onclick=sea.onclick=function(){go("sea"),changeSet(this.getAttribute("id")),setActiveClass(".butto","active",this)},dragger.ondblclick=function(){popLargeImage()};var pops=document.querySelector(".pops"),popsDiv=document.querySelector("#popsDiv"),popsTitle=document.querySelector(".popsTitle");theImage.onclick=popLargeImage,popsDiv.onclick=function(){pops.src="",popsDiv.classList.toggle("hidden")};