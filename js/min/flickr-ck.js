function wordInString(e,t){return new RegExp("\\b"+t+"\\b","gi").test(e)}function setImage(e){e=e||_Y+_X-1,theImage.src=e<images.length?images[e][0]:"../img/noImage.jpg"}function setTitle(){title.innerHTML=_Y+_X-1<images.length?"Title: "+images[_Y+_X-1][2]:"No More From "+tag}function reSetDragger(e){if(oldHeight>e&&hasDraged&&parseInt(elem.style.top)+1.5*grid_size>high){var t=Math.ceil(e/squaresAccross-1);elem.style.top=t*grid_size+"px";var i=parseInt(elem.style.top)/grid_size;console.log("t = "+i);var o=parseInt(elem.style.left)/grid_size;_X=o+1,_Y=i*squaresAccross,elem.innerHTML=i*squaresAccross+o+1||1,setImage(i*squaresAccross+o+1),setTitle()}oldHeight=e}function setDivHeight(e){var t=3,i;e%2!==0&&10>=e?(i=Math.round(e/3),console.log("first if"+i)):e%2!==0&&e>10?(i=Math.ceil(e/3),console.log("second if"+i)):e%2===0&&10>=e?(i=e/3,console.log("third if"+i)):e%2===0&&e>10&&(i=Math.round(e/2),console.log("fourth if"+i)),strips.style.height=i*grid_size+2*borderWidth+"px",strips.style.width=t*grid_size+2*borderWidth+"px",wide=document.querySelector("#strips").clientWidth,high=document.querySelector("#strips").clientHeight,squaresAccross=wide/grid_size,reSetDragger(e)}function makeArray(e){images=[];for(var t=0;t<jso.photos.photo.length;++t)if(wordInString(jso.photos.photo[t].tags,e)){var i="http://farm"+jso.photos.photo[t].farm+".staticflickr.com/"+jso.photos.photo[t].server+"/"+jso.photos.photo[t].id+"_"+jso.photos.photo[t].secret+"_m.jpg";tag=jso.photos.photo[t].tags.split(" ")[0],tit=jso.photos.photo[t].title,images.push([i,tag,tit])}}function jsonFlickrApi(e){jso=e,makeArray(tag),setImage(),setTitle(),setDivHeight(images.length)}function onDragMove(e){_X=e.position.x/grid_size+1,_Y=Math.floor(e.position.y/grid_size*squaresAccross),elem.innerHTML=_Y+_X,hasDraged=!0}function onDragEnd(){setImage(),setTitle()}function changeSet(e){makeArray(tag=e),tagName.innerHTML="Tag: "+e,setImage(),setTitle(),setDivHeight(images.length)}var elem=document.querySelector("#draggable"),strips=document.querySelector("#strips"),borderWidth=10;strips.style.borderWidth=borderWidth+"px";var theImage=document.querySelector("#theImage"),title=document.querySelector("#title"),tit,grid_size=elem.clientWidth,wide=document.querySelector("#strips").clientWidth,high=document.querySelector("#strips").clientHeight,squaresAccross=wide/grid_size,images=[],jso={},tag="france",hasDraged=!1,_X=0,_Y=1,oldHeight,draggie=new Draggabilly(elem,{grid:[grid_size,grid_size],containment:!0});draggie.on("dragMove",onDragMove),draggie.on("dragEnd",onDragEnd);var france=document.querySelector("#france"),field=document.querySelector("#field"),sea=document.querySelector("#sea"),tagName=document.querySelector("#tagName");tagName.innerHTML="Tag: "+tag,france.onclick=field.onclick=sea.onclick=function(){changeSet(this.getAttribute("id"))},elem.ondblclick=function(){alert("Don't click it dumbo, drag it")};