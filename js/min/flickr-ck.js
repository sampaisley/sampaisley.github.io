function wordInString(e,t){return new RegExp("\\b"+t+"\\b","gi").test(e)}function setImage(e){theImage.src=e<images.length?images[e][0]:"http://vapordirect.ie/template/eshop/images/no_product_photo.jpg"}function setTitle(){title.innerHTML=_Y+_X-1<images.length?"Title: "+images[_Y+_X-1][2]:"No More From "+tag}function reSetDragger(e){if(oldHeight>e&&hasDraged){var t=Math.ceil(e/squaresAccross-1);elem.style.top=t*grid_size+"px";var r=parseInt(elem.style.top)/grid_size,i=parseInt(elem.style.left)/grid_size;_X=i,_Y=r,elem.innerHTML=r*squaresAccross+i+1||1,setImage(r*squaresAccross+i),setTitle(),console.log(_Y+_X-1)}oldHeight=e}function setDivHeight(e){var t=3,r;e%2!==0&&10>=e?r=Math.round(e/3):e%2!==0&&e>10?r=Math.ceil(e/3):e%2===0&&10>=e?r=e/3:e%2===0&&e>10&&(r=Math.round(e/2)),strips.style.height=r*grid_size+2*borderWidth+"px",strips.style.width=t*grid_size+2*borderWidth+"px",wide=document.querySelector("#strips").clientWidth,squaresAccross=wide/grid_size,reSetDragger(e)}function makeArray(e){images=[];for(var t=0;t<jso.photos.photo.length;++t)if(wordInString(jso.photos.photo[t].tags,e)){var r="http://farm"+jso.photos.photo[t].farm+".staticflickr.com/"+jso.photos.photo[t].server+"/"+jso.photos.photo[t].id+"_"+jso.photos.photo[t].secret+"_m.jpg";tag=jso.photos.photo[t].tags.split(" ")[0],tit=jso.photos.photo[t].title,images.push([r,tag,tit])}}function jsonFlickrApi(e){jso=e,makeArray(tag),setImage(_Y+_X-1),setTitle(),setDivHeight(images.length)}function onDragMove(e){_X=e.position.x/grid_size+1,_Y=Math.floor(e.position.y/grid_size*squaresAccross),elem.innerHTML=_Y+_X,hasDraged=!0}function onDragEnd(){setImage(_Y+_X-1),setTitle()}function changeSet(e){makeArray(tag=e),tagName.innerHTML="Tag: "+e,setImage(_Y+_X-1),setTitle(),setDivHeight(images.length)}var elem=document.querySelector("#draggable"),strips=document.querySelector("#strips"),borderWidth=10;strips.style.borderWidth=borderWidth+"px";var theImage=document.querySelector("#theImage"),title=document.querySelector("#title"),tit,grid_size=elem.clientWidth,wide=document.querySelector("#strips").clientWidth,squaresAccross=wide/grid_size,images=[],jso={},tag="france",hasDraged=!1,_X=0,_Y=1,oldHeight;document.flickrURL="https://api.flickr.com/services/rest/?method=flickr.people.getPhotos&api_key=2fdc79859cd894e55ee6fb2d0a4e6acf&user_id=100786833%40N08&extras=tags&format=json";var script=document.createElement("script");script.setAttribute("type","text/javascript"),script.setAttribute("src",document.flickrURL),document.head.appendChild(script);var draggie=new Draggabilly(elem,{grid:[grid_size,grid_size],containment:!0});draggie.on("dragMove",onDragMove),draggie.on("dragEnd",onDragEnd);var france=document.querySelector("#france"),field=document.querySelector("#field"),sea=document.querySelector("#sea"),tagName=document.querySelector("#tagName");tagName.innerHTML="Tag: "+tag,france.onclick=field.onclick=sea.onclick=function(){changeSet(this.getAttribute("id"))},elem.ondblclick=function(){alert("Don't click it dumbo, drag it")};