<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="icon" href="img/favico.ico"/>
    <script src='https://cdn.firebase.com/js/client/1.0.11/firebase.js'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
    <script type='text/javascript'
            src='https://cdn.firebase.com/js/simple-login/1.3.2/firebase-simple-login.js'>
    </script>

    <style>
        .error {
            background-color: rgba(139, 0, 0, 0.13);
        }

        .errorString {
            color: #cd5c5c;
        }
    </style>
    <title>contact</title>
</head>
<body>
<div id='messagesDiv'></div>
<form>
    <input type='text' id='nameInput' placeholder='Name' required/>
    <input type='text' id='messageInput' placeholder='Message' required/>
    <input type="email" id="emailInput" placeholder="Email" required/>
    <input type="submit" value="btn" id="btn"/>
</form>
<button id="login"> in</button>
<button id="logout">out</button>
<button id="delete">delete</button>
<h3 id="alert"></h3>
<script>
    var inp = 'pongo';
    var url = 'https://paisley2.firebaseio.com/';
    var myDataRef = new Firebase(url);
    var auth = new FirebaseSimpleLogin(myDataRef, function (error, user) {
        if (error) {
            // an error occurred while attempting login
            console.log(error);
        } else if (user) {
            // user authenticated with Firebase
            // auth.login('github');
            console.log('User ID: ' + user.uid + ', Provider: ' + user.provider);

        } else {
            console.log(' is logged out') ;
        }
    });


    $('#login').click(function () {
        auth.login('password', {
            email: 'foo@foo.foo',
            password: 'pass123'
            /////

        });
          console.log(auth);
    });
    $('#logout').click(function () {
        auth.logout();
        //console.log('User ID: ' + user.uid + ', Provider: ' + user.provider);
    } );
    var onComplete = function(error) {
        if (error)
            alert('Synchronization failed.');
        else
            alert('Synchronization succeeded.');
    };
    $('#delete').click(function () {
        myDataRef.remove(onComplete);
        console.log('ddddd');
    } );
    $('#btn').click(function (e) {

        if (verifyEmail()) {
         e.preventDefault();
         var name = $('#nameInput').val();
         var text = $('#messageInput').val();
         var email = $('#emailInput').val();
         myDataRef.push({name: name, text: text, email: email});
         $('#messageInput').val('');
         } else {
         _$('#alert').innerHTML = "do it proper! <span class='errorString'>" + errstring + '</span>';
         }
    });

    myDataRef.on('child_added', function (snapshot) {
        var message = snapshot.val();
        displayChatMessage(message.name, message.text, message.email);
    });
    function displayChatMessage(name, text, email) {
        $('<div/>').text(name + ' : ' + text + ' :: ' + email).appendTo($('#messagesDiv'));
        //$('#messagesDiv')[0].scrollTop = $('#messagesDiv')[0].scrollHeight;
    }


</script>
<script src="js/mail-van.js"></script>
</body>
</html>